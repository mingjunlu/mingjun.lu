---
import { increasePostViewBySlug } from 'src/utils/post';

function formatViewCount(count: number): string {
  const formatter = new Intl.NumberFormat('en-US', {
    notation: 'compact',
  });
  return formatter.format(count);
}

type Props = {
  viewCount?: number;
};

const { slug } = Astro.params;
const viewCount = Astro.props.viewCount ?? (await increasePostViewBySlug(slug));
---

<Fragment>
  {formatViewCount(viewCount)}
</Fragment>
